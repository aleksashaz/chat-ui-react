"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.MuiFileInput = MuiFileInput;

var _core = require("@material-ui/core");

var _icons = require("@material-ui/icons");

var _react = _interopRequireDefault(require("react"));

const useStyles = (0, _core.makeStyles)(theme => ({
  container: {
    flex: '1 1 auto',
    maxWidth: '100%',
    display: 'flex',
    flexDirection: 'column',
    '& > *': {
      flex: '0 0 auto',
      maxWidth: '100%'
    },
    '& > * + *': {
      marginTop: theme.spacing(1)
    }
  },
  buttons: {
    display: 'flex',
    '& > *': {
      flex: '1 1 auto',
      minWidth: 0
    },
    '& > * + *': {
      marginLeft: theme.spacing(1)
    }
  }
}));

function MuiFileInput({
  chatController,
  actionRequest
}) {
  const classes = useStyles();
  const chatCtl = chatController;

  const [files, setFiles] = _react.default.useState([]);

  const handleFileChange = _react.default.useCallback(fileList => {
    // Convert FileList to File[]
    const fileArray = [];

    if (fileList) {
      for (let i = 0; i < fileList.length; i += 1) {
        const file = fileList.item(i);

        if (file) {
          fileArray.push(file);
        }
      }
    }

    setFiles(fileArray);
  }, []);

  const setResponse = _react.default.useCallback(() => {
    if (files.length > 0) {
      const value = files.map(f => f.name).toString();
      const res = {
        type: 'file',
        value,
        files
      };
      chatCtl.setActionResponse(actionRequest, res);
    }
  }, [actionRequest, chatCtl, files]);

  const sendButtonText = actionRequest.sendButtonText ? actionRequest.sendButtonText : 'Send';
  return /*#__PURE__*/_react.default.createElement("div", {
    className: classes.container
  }, /*#__PURE__*/_react.default.createElement(_core.List, null, files.map(f => /*#__PURE__*/_react.default.createElement("div", {
    key: `${f.name}-${f.size}`
  }, /*#__PURE__*/_react.default.createElement(_core.Divider, null), /*#__PURE__*/_react.default.createElement(_core.ListItem, {
    key: f.name
  }, /*#__PURE__*/_react.default.createElement(_core.ListItemIcon, null, /*#__PURE__*/_react.default.createElement(_icons.AttachFile, null)), /*#__PURE__*/_react.default.createElement(_core.Typography, {
    style: {
      overflowWrap: 'break-word',
      minWidth: 0
    }
  }, f.name))))), /*#__PURE__*/_react.default.createElement("div", {
    className: classes.buttons
  }, /*#__PURE__*/_react.default.createElement(_core.Button, {
    disabled: false,
    component: "label",
    variant: "contained",
    color: "primary",
    startIcon: /*#__PURE__*/_react.default.createElement(_icons.Folder, null)
  }, "Select file", /*#__PURE__*/_react.default.createElement("input", {
    type: "file",
    accept: actionRequest.accept,
    multiple: actionRequest.multiple,
    onChange: e => handleFileChange(e.target.files),
    style: {
      display: 'none'
    }
  })), /*#__PURE__*/_react.default.createElement(_core.Button, {
    type: "button",
    onClick: setResponse,
    disabled: files.length === 0,
    variant: "contained",
    color: "primary",
    startIcon: /*#__PURE__*/_react.default.createElement(_icons.Send, null)
  }, sendButtonText)));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9tdWkvTXVpRmlsZUlucHV0LnRzeCJdLCJuYW1lcyI6WyJ1c2VTdHlsZXMiLCJ0aGVtZSIsImNvbnRhaW5lciIsImZsZXgiLCJtYXhXaWR0aCIsImRpc3BsYXkiLCJmbGV4RGlyZWN0aW9uIiwibWFyZ2luVG9wIiwic3BhY2luZyIsImJ1dHRvbnMiLCJtaW5XaWR0aCIsIm1hcmdpbkxlZnQiLCJNdWlGaWxlSW5wdXQiLCJjaGF0Q29udHJvbGxlciIsImFjdGlvblJlcXVlc3QiLCJjbGFzc2VzIiwiY2hhdEN0bCIsImZpbGVzIiwic2V0RmlsZXMiLCJSZWFjdCIsInVzZVN0YXRlIiwiaGFuZGxlRmlsZUNoYW5nZSIsInVzZUNhbGxiYWNrIiwiZmlsZUxpc3QiLCJmaWxlQXJyYXkiLCJpIiwibGVuZ3RoIiwiZmlsZSIsIml0ZW0iLCJwdXNoIiwic2V0UmVzcG9uc2UiLCJ2YWx1ZSIsIm1hcCIsImYiLCJuYW1lIiwidG9TdHJpbmciLCJyZXMiLCJ0eXBlIiwic2V0QWN0aW9uUmVzcG9uc2UiLCJzZW5kQnV0dG9uVGV4dCIsInNpemUiLCJvdmVyZmxvd1dyYXAiLCJhY2NlcHQiLCJtdWx0aXBsZSIsImUiLCJ0YXJnZXQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBOztBQVVBOztBQUtBOztBQUtBLE1BQU1BLFNBQVMsR0FBRyxzQkFBWUMsS0FBRCxLQUFtQjtBQUM5Q0MsRUFBQUEsU0FBUyxFQUFFO0FBQ1RDLElBQUFBLElBQUksRUFBRSxVQURHO0FBRVRDLElBQUFBLFFBQVEsRUFBRSxNQUZEO0FBR1RDLElBQUFBLE9BQU8sRUFBRSxNQUhBO0FBSVRDLElBQUFBLGFBQWEsRUFBRSxRQUpOO0FBS1QsYUFBUztBQUNQSCxNQUFBQSxJQUFJLEVBQUUsVUFEQztBQUVQQyxNQUFBQSxRQUFRLEVBQUU7QUFGSCxLQUxBO0FBU1QsaUJBQWE7QUFDWEcsTUFBQUEsU0FBUyxFQUFFTixLQUFLLENBQUNPLE9BQU4sQ0FBYyxDQUFkO0FBREE7QUFU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a0JBQ0UsNkJBQUMsWUFBRDtBQUNFLElBQUEsUUFBUSxFQUFFLEtBRFo7QUFFRSxJQUFBLFNBQVMsRUFBQyxPQUZaO0FBR0UsSUFBQSxPQUFPLEVBQUMsV0FIVjtBQUlFLElBQUEsS0FBSyxFQUFDLFNBSlI7QUFLRSxJQUFBLFNBQVMsZUFBRSw2QkFBQyxhQUFEO0FBTGIsaUNBUUU7QUFDRSxJQUFBLElBQUksRUFBQyxNQURQO0FBRUUsSUFBQSxNQUFNLEVBQUVLLGFBQWEsQ0FBQzRCLE1BRnhCO0FBR0UsSUFBQSxRQUFRLEVBQUU1QixhQUFhLENBQUM2QixRQUgxQjtBQUlFLElBQUEsUUFBUSxFQUFHQyxDQUFELElBQWF2QixnQkFBZ0IsQ0FBQ3VCLENBQUMsQ0FBQ0MsTUFBRixDQUFTNUIsS0FBVixDQUp6QztBQUtFLElBQUEsS0FBSyxFQUFFO0FBQUVaLE1BQUFBLE9BQU8sRUFBRTtBQUFYO0FBTFQsSUFSRixDQURGLGVBaUJFLDZCQUFDLFlBQUQ7QUFDRSxJQUFBLElBQUksRUFBQyxRQURQO0FBRUUsSUFBQSxPQUFPLEVBQUV5QixXQUZYO0FBR0UsSUFBQSxRQUFRLEVBQUViLEtBQUssQ0FBQ1MsTUFBTixLQUFpQixDQUg3QjtBQUlFLElBQUEsT0FBTyxFQUFDLFdBSlY7QUFLRSxJQUFBLEtBQUssRUFBQyxTQUxSO0FBTUUsSUFBQSxTQUFTLGVBQUUsNkJBQUMsV0FBRDtBQU5iLEtBUUdhLGNBUkgsQ0FqQkYsQ0FqQkYsQ0FERjtBQWdERCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEJ1dHRvbixcbiAgRGl2aWRlcixcbiAgTGlzdCxcbiAgTGlzdEl0ZW0sXG4gIExpc3RJdGVtSWNvbixcbiAgVGhlbWUsXG4gIFR5cG9ncmFwaHksXG4gIG1ha2VTdHlsZXMsXG59IGZyb20gJ0BtYXRlcmlhbC11aS9jb3JlJztcbmltcG9ydCB7XG4gIEF0dGFjaEZpbGUgYXMgQXR0YWNoRmlsZUljb24sXG4gIEZvbGRlciBhcyBGb2xkZXJJY29uLFxuICBTZW5kIGFzIFNlbmRJY29uLFxufSBmcm9tICdAbWF0ZXJpYWwtdWkvaWNvbnMnO1xuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcblxuaW1wb3J0IHsgQ2hhdENvbnRyb2xsZXIgfSBmcm9tICcuLi9jaGF0LWNvbnRyb2xsZXInO1xuaW1wb3J0IHsgRmlsZUFjdGlvblJlcXVlc3QsIEZpbGVBY3Rpb25SZXNwb25zZSB9IGZyb20gJy4uL2NoYXQtdHlwZXMnO1xuXG5jb25zdCB1c2VTdHlsZXMgPSBtYWtlU3R5bGVzKCh0aGVtZTogVGhlbWUpID0+ICh7XG4gIGNvbnRhaW5lcjoge1xuICAgIGZsZXg6ICcxIDEgYXV0bycsXG4gICAgbWF4V2lkdGg6ICcxMDAlJyxcbiAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgZmxleERpcmVjdGlvbjogJ2NvbHVtbicsXG4gICAgJyYgPiAqJzoge1xuICAgICAgZmxleDogJzAgMCBhdXRvJyxcbiAgICAgIG1heFdpZHRoOiAnMTAwJScsXG4gICAgfSxcbiAgICAnJiA+ICogKyAqJzoge1xuICAgICAgbWFyZ2luVG9wOiB0aGVtZS5zcGFjaW5nKDEpLFxuICAgIH0sXG4gIH0sXG4gIGJ1dHRvbnM6IHtcbiAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgJyYgPiAqJzoge1xuICAgICAgZmxleDogJzEgMSBhdXRvJyxcbiAgICAgIG1pbldpZHRoOiAwLFxuICAgIH0sXG4gICAgJyYgPiAqICsgKic6IHtcbiAgICAgIG1hcmdpbkxlZnQ6IHRoZW1lLnNwYWNpbmcoMSksXG4gICAgfSxcbiAgfSxcbn0pKTtcblxuZXhwb3J0IGZ1bmN0aW9uIE11aUZpbGVJbnB1dCh7XG4gIGNoYXRDb250cm9sbGVyLFxuICBhY3Rpb25SZXF1ZXN0LFxufToge1xuICBjaGF0Q29udHJvbGxlcjogQ2hhdENvbnRyb2xsZXI7XG4gIGFjdGlvblJlcXVlc3Q6IEZpbGVBY3Rpb25SZXF1ZXN0O1xufSk6IFJlYWN0LlJlYWN0RWxlbWVudCB7XG4gIGNvbnN0IGNsYXNzZXMgPSB1c2VTdHlsZXMoKTtcbiAgY29uc3QgY2hhdEN0bCA9IGNoYXRDb250cm9sbGVyO1xuICBjb25zdCBbZmlsZXMsIHNldEZpbGVzXSA9IFJlYWN0LnVzZVN0YXRlPEZpbGVbXT4oW10pO1xuXG4gIGNvbnN0IGhhbmRsZUZpbGVDaGFuZ2UgPSBSZWFjdC51c2VDYWxsYmFjayhcbiAgICAoZmlsZUxpc3Q6IEZpbGVMaXN0IHwgbnVsbCk6IHZvaWQgPT4ge1xuICAgICAgLy8gQ29udmVydCBGaWxlTGlzdCB0byBGaWxlW11cbiAgICAgIGNvbnN0IGZpbGVBcnJheTogRmlsZVtdID0gW107XG4gICAgICBpZiAoZmlsZUxpc3QpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaWxlTGlzdC5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgIGNvbnN0IGZpbGUgPSBmaWxlTGlzdC5pdGVtKGkpO1xuICAgICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBmaWxlQXJyYXkucHVzaChmaWxlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHNldEZpbGVzKGZpbGVBcnJheSk7XG4gICAgfSxcbiAgICBbXSxcbiAgKTtcblxuICBjb25zdCBzZXRSZXNwb25zZSA9IFJlYWN0LnVzZUNhbGxiYWNrKCgpOiB2b2lkID0+IHtcbiAgICBpZiAoZmlsZXMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgdmFsdWUgPSBmaWxlcy5tYXAoKGYpID0+IGYubmFtZSkudG9TdHJpbmcoKTtcbiAgICAgIGNvbnN0IHJlczogRmlsZUFjdGlvblJlc3BvbnNlID0geyB0eXBlOiAnZmlsZScsIHZhbHVlLCBmaWxlcyB9O1xuICAgICAgY2hhdEN0bC5zZXRBY3Rpb25SZXNwb25zZShhY3Rpb25SZXF1ZXN0LCByZXMpO1xuICAgIH1cbiAgfSwgW2FjdGlvblJlcXVlc3QsIGNoYXRDdGwsIGZpbGVzXSk7XG5cbiAgY29uc3Qgc2VuZEJ1dHRvblRleHQgPSBhY3Rpb25SZXF1ZXN0LnNlbmRCdXR0b25UZXh0XG4gICAgPyBhY3Rpb25SZXF1ZXN0LnNlbmRCdXR0b25UZXh0XG4gICAgOiAnU2VuZCc7XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT17Y2xhc3Nlcy5jb250YWluZXJ9PlxuICAgICAgPExpc3Q+XG4gICAgICAgIHtmaWxlcy5tYXAoKGYpID0+IChcbiAgICAgICAgICA8ZGl2IGtleT17YCR7Zi5uYW1lfS0ke2Yuc2l6ZX1gfT5cbiAgICAgICAgICAgIDxEaXZpZGVyIC8+XG4gICAgICAgICAgICA8TGlzdEl0ZW0ga2V5PXtmLm5hbWV9PlxuICAgICAgICAgICAgICA8TGlzdEl0ZW1JY29uPlxuICAgICAgICAgICAgICAgIDxBdHRhY2hGaWxlSWNvbiAvPlxuICAgICAgICAgICAgICA8L0xpc3RJdGVtSWNvbj5cbiAgICAgICAgICAgICAgPFR5cG9ncmFwaHkgc3R5bGU9e3sgb3ZlcmZsb3dXcmFwOiAnYnJlYWstd29yZCcsIG1pbldpZHRoOiAwIH19PlxuICAgICAgICAgICAgICAgIHtmLm5hbWV9XG4gICAgICAgICAgICAgIDwvVHlwb2dyYXBoeT5cbiAgICAgICAgICAgICAgey8qIDxMaXN0SXRlbVRleHQgcHJpbWFyeT17Zi5uYW1lfSAvPiAqL31cbiAgICAgICAgICAgIDwvTGlzdEl0ZW0+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICkpfVxuICAgICAgPC9MaXN0PlxuICAgICAgPGRpdiBjbGFzc05hbWU9e2NsYXNzZXMuYnV0dG9uc30+XG4gICAgICAgIDxCdXR0b25cbiAgICAgICAgICBkaXNhYmxlZD17ZmFsc2V9XG4gICAgICAgICAgY29tcG9uZW50PVwibGFiZWxcIlxuICAgICAgICAgIHZhcmlhbnQ9XCJjb250YWluZWRcIlxuICAgICAgICAgIGNvbG9yPVwicHJpbWFyeVwiXG4gICAgICAgICAgc3RhcnRJY29uPXs8Rm9sZGVySWNvbiAvPn1cbiAgICAgICAgPlxuICAgICAgICAgIFNlbGVjdCBmaWxlXG4gICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICB0eXBlPVwiZmlsZVwiXG4gICAgICAgICAgICBhY2NlcHQ9e2FjdGlvblJlcXVlc3QuYWNjZXB0fVxuICAgICAgICAgICAgbXVsdGlwbGU9e2FjdGlvblJlcXVlc3QubXVsdGlwbGV9XG4gICAgICAgICAgICBvbkNoYW5nZT17KGUpOiB2b2lkID0+IGhhbmRsZUZpbGVDaGFuZ2UoZS50YXJnZXQuZmlsZXMpfVxuICAgICAgICAgICAgc3R5bGU9e3sgZGlzcGxheTogJ25vbmUnIH19XG4gICAgICAgICAgLz5cbiAgICAgICAgPC9CdXR0b24+XG4gICAgICAgIDxCdXR0b25cbiAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICBvbkNsaWNrPXtzZXRSZXNwb25zZX1cbiAgICAgICAgICBkaXNhYmxlZD17ZmlsZXMubGVuZ3RoID09PSAwfVxuICAgICAgICAgIHZhcmlhbnQ9XCJjb250YWluZWRcIlxuICAgICAgICAgIGNvbG9yPVwicHJpbWFyeVwiXG4gICAgICAgICAgc3RhcnRJY29uPXs8U2VuZEljb24gLz59XG4gICAgICAgID5cbiAgICAgICAgICB7c2VuZEJ1dHRvblRleHR9XG4gICAgICAgIDwvQnV0dG9uPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICk7XG59XG4iXX0=